import{d as $,r as k,k as W,l as V,c as v,o as s,m as M,e,j as b,t as C,B as g,w as m,C as X,p as F,v as L,i as D,_ as B,q as z,a as N,s as U,x as Y,g as d,h as w,n as Z,f as j,F as q,y as ee,b as te,z as oe,D as T,E as se,G as S,H as ae}from"./index-DnY5Mj3-.js";import{u as re,f as ce,E as le,R as ne,a as ie}from"./helpers-CoucvtTK.js";const ue={class:"project-modal-content"},de={class:"project-modal-header flex justify-between align-center"},pe={class:"form-group"},je={class:"form-group"},ve={class:"flex justify-end align-center"},me=$({__name:"ProjectModal",props:{projectToEdit:{default:null}},emits:["create","close","update"],setup(p,{emit:_}){const n=_,r=k(""),c=k("");W(()=>p.projectToEdit,a=>{a?(r.value=a.title,c.value=a.dueDate):(r.value="",c.value="")},{immediate:!0});const l=V(()=>r.value.trim().length>0&&c.value.trim().length>0),f=()=>{if(!l.value)return;const a={title:r.value.trim(),dueDate:c.value};p.projectToEdit&&p.projectToEdit.id?n("update",{...a,id:p.projectToEdit.id}):n("create",a)},y=()=>{n("close")};return(a,t)=>(s(),v("div",{class:"project-modal flex justify-center align-center",onClick:M(y,["self"])},[e("div",ue,[e("div",de,[e("h2",null,C(a.projectToEdit?"Edit project":"Create project"),1),b(g,{class:"cursor","no-padding":"",size:"sm",variant:"ghost","text-color":"var(--color-text)",onClickButton:y},{default:m(()=>[b(X)]),_:1})]),e("form",{class:"form",onSubmit:M(f,["prevent"])},[e("div",pe,[t[2]||(t[2]=e("label",{class:"form-label",for:"title"},"Title",-1)),F(e("input",{id:"title","onUpdate:modelValue":t[0]||(t[0]=o=>r.value=o),class:"form-input",required:""},null,512),[[L,r.value]])]),e("div",je,[t[3]||(t[3]=e("label",{class:"form-label",for:"due-date"},"Due date",-1)),F(e("input",{id:"due-date","onUpdate:modelValue":t[1]||(t[1]=o=>c.value=o),class:"form-input",type:"date"},null,512),[[L,c.value]])]),e("div",ve,[b(g,{type:"submit",disabled:!l.value},{default:m(()=>[D(C(a.projectToEdit?"Update":"Create"),1)]),_:1},8,["disabled"])])],32)])]))}}),fe=B(me,[["__scopeId","data-v-61b14bcd"]]),ye={class:"project-card flex column"},_e={class:"project-row align-center"},Pe={key:1},ke={class:"mobile-view-wrap flex justify-between align-center"},ge={class:"project-actions flex justify-end"},he=$({__name:"ProjectItem",props:{project:{}},emits:["edit-project","remove-project"],setup(p,{emit:_}){const n=p,r=_,l=z().name==="projects",f=N(),{isAuthenticated:y}=U(f),a=V(()=>re(n.project.dueDate));return(t,o)=>{const P=Y("RouterLink");return s(),v("div",ye,[e("div",_e,[e("div",null,[w(y)?(s(),d(P,{key:0,to:{name:"projectDetails",params:{id:t.project.id}},class:"project-link"},{default:m(()=>[D(C(t.project.title),1)]),_:1},8,["to"])):(s(),v("div",Pe,C(t.project.title),1))]),e("div",ke,[e("div",{class:Z({[a.value]:w(y)})},C(w(ce)(t.project.dueDate)),3),e("div",ge,[l?(s(),d(g,{key:0,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[0]||(o[0]=h=>r("edit-project"))},{default:m(()=>[b(le)]),_:1})):j("",!0),l?(s(),d(g,{key:1,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[1]||(o[1]=h=>r("remove-project"))},{default:m(()=>[b(ne)]),_:1})):j("",!0)])])])])}}}),be=B(he,[["__scopeId","data-v-d39f92af"]]),Ce={class:"project-table flex column"},we=$({__name:"ProjectTable",props:{projects:{}},emits:["edit-project","remove-project"],setup(p,{emit:_}){const n=_;return(r,c)=>(s(),v("div",Ce,[c[0]||(c[0]=e("div",{class:"project-header align-center"},[e("div",null,"Project title"),e("div",null,"Due date"),e("div")],-1)),(s(!0),v(q,null,ee(r.projects,l=>(s(),d(be,{key:l.id,project:l,onEditProject:f=>n("edit-project",l),onRemoveProject:f=>n("remove-project",l.id)},null,8,["project","onEditProject","onRemoveProject"]))),128))]))}}),Ee=B(we,[["__scopeId","data-v-82953f51"]]),xe={class:"container"},Te={key:1,class:"project-page-header flex justify-between align-center"},De=$({__name:"ProjectList",setup(p){const n=z().name==="projects",{fetchProjectsAllAsync:r,createProjectAsync:c,updateProjectAsync:l,removeProjectAsync:f}=te(),y=N(),{isAuthenticated:a}=U(y),t=k([]),o=k(!1),P=k(!1),h=k(null);oe(()=>{E()});const A=()=>{h.value=null,P.value=!0},G=u=>{h.value=u,P.value=!0},R=()=>{P.value=!1},H=async u=>{o.value=!0;try{await c(u),await E(),S("Project created successfully.")}catch{T("Failed to create project.")}finally{o.value=!1,R()}},O=async u=>{o.value=!0;try{await l(u),await E(),S("Project updated successfully.")}catch{T("Failed to update project.")}finally{o.value=!1,R()}},J=async u=>{const i=ae(),{removeTaskAsync:K}=i,Q=i.tasks.filter(x=>x.projectId===u);let I=[];o.value=!0;try{await f(u),I=Q.map(x=>K(x.id)),await Promise.all(I),await E(),S("Project deleted successfully.")}catch{T("Failed to remove project.")}finally{o.value=!1}},E=async()=>{o.value=!0;try{t.value=await r()}catch{T("Failed to fetch projects."),t.value=[]}finally{o.value=!1}};return(u,i)=>(s(),v("section",xe,[o.value?(s(),d(se,{key:0})):j("",!0),n?(s(),v("div",Te,[i[1]||(i[1]=e("h1",null,"Projects",-1)),w(a)&&t.value.length>0?(s(),d(g,{key:0,onClickButton:A},{default:m(()=>i[0]||(i[0]=[D(" Create project ")])),_:1,__:[0]})):j("",!0)])):j("",!0),t.value.length>0?(s(),d(Ee,{key:2,projects:t.value,onEditProject:G,onRemoveProject:J},null,8,["projects"])):(s(),v(q,{key:3},[n?(s(),d(ie,{key:0,title:"No projects yet",message:"Start by creating your first project."},{action:m(()=>[w(a)?(s(),d(g,{key:0,onClickButton:A},{default:m(()=>i[2]||(i[2]=[D(" Create project ")])),_:1,__:[2]})):j("",!0)]),_:1})):j("",!0)],64)),P.value?(s(),d(fe,{key:4,"project-to-edit":h.value,onClose:R,onCreate:H,onUpdate:O},null,8,["project-to-edit"])):j("",!0)]))}}),Re=B(De,[["__scopeId","data-v-6119e3bb"]]);export{Re as P};
