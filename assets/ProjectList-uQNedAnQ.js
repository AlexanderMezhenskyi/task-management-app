import{d as $,r as P,k as Q,l as W,c as v,o as t,m as M,e,j as g,t as h,B as k,w as m,C as X,p as F,v as L,i as x,_ as B,q as V,a as N,s as z,x as Y,g as d,h as T,f as j,F as U,y as Z,b as ee,z as te,D as E,E as oe,G as A,H as se}from"./index-3qcvwLtC.js";import{f as ae,E as re,R as ce,a as le}from"./helpers-CR7rCIbh.js";const ne={class:"project-modal-content"},ie={class:"project-modal-header flex justify-between align-center"},ue={class:"form-group"},de={class:"form-group"},pe={class:"flex justify-end align-center"},je=$({__name:"ProjectModal",props:{projectToEdit:{default:null}},emits:["create","close","update"],setup(f,{emit:_}){const c=_,l=P(""),r=P("");Q(()=>f.projectToEdit,o=>{o?(l.value=o.title,r.value=o.dueDate):(l.value="",r.value="")},{immediate:!0});const n=W(()=>l.value.trim().length>0&&r.value.trim().length>0),y=()=>{if(!n.value)return;const o={title:l.value.trim(),dueDate:r.value};f.projectToEdit&&f.projectToEdit.id?c("update",{...o,id:f.projectToEdit.id}):c("create",o)},p=()=>{c("close")};return(o,s)=>(t(),v("div",{class:"project-modal flex justify-center align-center",onClick:M(p,["self"])},[e("div",ne,[e("div",ie,[e("h2",null,h(o.projectToEdit?"Edit project":"Create project"),1),g(k,{class:"cursor","no-padding":"",size:"sm",variant:"ghost","text-color":"var(--color-text)",onClickButton:p},{default:m(()=>[g(X)]),_:1})]),e("form",{class:"form",onSubmit:M(y,["prevent"])},[e("div",ue,[s[2]||(s[2]=e("label",{class:"form-label",for:"title"},"Title",-1)),F(e("input",{id:"title","onUpdate:modelValue":s[0]||(s[0]=a=>l.value=a),class:"form-input",required:""},null,512),[[L,l.value]])]),e("div",de,[s[3]||(s[3]=e("label",{class:"form-label",for:"due-date"},"Due date",-1)),F(e("input",{id:"due-date","onUpdate:modelValue":s[1]||(s[1]=a=>r.value=a),class:"form-input",type:"date"},null,512),[[L,r.value]])]),e("div",pe,[g(k,{type:"submit",disabled:!n.value},{default:m(()=>[x(h(o.projectToEdit?"Update":"Create"),1)]),_:1},8,["disabled"])])],32)])]))}}),ve=B(je,[["__scopeId","data-v-61b14bcd"]]),me={class:"project-card flex column"},fe={class:"project-row align-center"},ye={key:1},_e={class:"mobile-view-wrap flex justify-between align-center"},Pe={class:"project-actions flex justify-end"},ke=$({__name:"ProjectItem",props:{project:{}},emits:["edit-project","remove-project"],setup(f,{emit:_}){const c=_,r=V().name==="projects",n=N(),{isAuthenticated:y}=z(n);return(p,o)=>{const s=Y("RouterLink");return t(),v("div",me,[e("div",fe,[e("div",null,[T(y)?(t(),d(s,{key:0,to:{name:"projectDetails",params:{id:p.project.id}},class:"project-link"},{default:m(()=>[x(h(p.project.title),1)]),_:1},8,["to"])):(t(),v("div",ye,h(p.project.title),1))]),e("div",_e,[e("div",null,h(T(ae)(p.project.dueDate)),1),e("div",Pe,[r?(t(),d(k,{key:0,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[0]||(o[0]=a=>c("edit-project"))},{default:m(()=>[g(re)]),_:1})):j("",!0),r?(t(),d(k,{key:1,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[1]||(o[1]=a=>c("remove-project"))},{default:m(()=>[g(ce)]),_:1})):j("",!0)])])])])}}}),ge=B(ke,[["__scopeId","data-v-0143f52c"]]),he={class:"project-table flex column"},be=$({__name:"ProjectTable",props:{projects:{}},emits:["edit-project","remove-project"],setup(f,{emit:_}){const c=_;return(l,r)=>(t(),v("div",he,[r[0]||(r[0]=e("div",{class:"project-header align-center"},[e("div",null,"Project title"),e("div",null,"Due date"),e("div")],-1)),(t(!0),v(U,null,Z(l.projects,n=>(t(),d(ge,{key:n.id,project:n,onEditProject:y=>c("edit-project",n),onRemoveProject:y=>c("remove-project",n.id)},null,8,["project","onEditProject","onRemoveProject"]))),128))]))}}),we=B(be,[["__scopeId","data-v-82953f51"]]),Ce={class:"container"},Ee={key:1,class:"project-page-header flex justify-between align-center"},xe=$({__name:"ProjectList",setup(f){const c=V().name==="projects",{fetchProjectsAllAsync:l,createProjectAsync:r,updateProjectAsync:n,removeProjectAsync:y}=ee(),p=N(),{isAuthenticated:o}=z(p),s=P([]),a=P(!1),b=P(!1),R=P(null);te(()=>{w()});const S=()=>{R.value=null,b.value=!0},q=u=>{R.value=u,b.value=!0},D=()=>{b.value=!1},G=async u=>{a.value=!0;try{await r(u),await w(),A("Project created successfully.")}catch{E("Failed to create project.")}finally{a.value=!1,D()}},H=async u=>{a.value=!0;try{await n(u),await w(),A("Project updated successfully.")}catch{E("Failed to update project.")}finally{a.value=!1,D()}},O=async u=>{const i=se(),{removeTaskAsync:J}=i,K=i.tasks.filter(C=>C.projectId===u);let I=[];a.value=!0;try{await y(u),I=K.map(C=>J(C.id)),await Promise.all(I),await w(),A("Project deleted successfully.")}catch{E("Failed to remove project.")}finally{a.value=!1}},w=async()=>{a.value=!0;try{s.value=await l()}catch{E("Failed to fetch projects.")}finally{a.value=!1}};return(u,i)=>(t(),v("section",Ce,[a.value?(t(),d(oe,{key:0})):j("",!0),c?(t(),v("div",Ee,[i[1]||(i[1]=e("h1",null,"Projects",-1)),T(o)&&s.value.length>0?(t(),d(k,{key:0,onClickButton:S},{default:m(()=>i[0]||(i[0]=[x(" Create project ")])),_:1,__:[0]})):j("",!0)])):j("",!0),s.value.length>0?(t(),d(we,{key:2,projects:s.value,onEditProject:q,onRemoveProject:O},null,8,["projects"])):(t(),v(U,{key:3},[c?(t(),d(le,{key:0,title:"No projects yet",message:"Start by creating your first project."},{action:m(()=>[T(o)?(t(),d(k,{key:0,onClickButton:S},{default:m(()=>i[2]||(i[2]=[x(" Create project ")])),_:1,__:[2]})):j("",!0)]),_:1})):j("",!0)],64)),b.value?(t(),d(ve,{key:4,"project-to-edit":R.value,onClose:D,onCreate:G,onUpdate:H},null,8,["project-to-edit"])):j("",!0)]))}}),Be=B(xe,[["__scopeId","data-v-a084ced6"]]);export{Be as P};
