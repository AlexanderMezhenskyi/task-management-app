import{d as $,r as y,k as K,l as Q,c as m,m as M,b as e,h as b,t as C,B as k,w as j,p as S,v as F,C as W,j as x,o as t,_ as B,q as L,u as V,s as N,x as X,f as d,g as T,e as v,F as z,y as Y,a as Z,z as ee,E as te,D as oe,G as se}from"./index-D3OWCAS7.js";import{f as ae,E as re,R as le,a as ne}from"./helpers-DwjziIZx.js";const ce={class:"project-modal-content"},ie={class:"project-modal-header flex justify-between align-center"},ue={class:"form-group"},de={class:"form-group"},pe={class:"flex justify-end align-center"},ve=$({__name:"ProjectModal",props:{projectToEdit:{default:null}},emits:["create","close","update"],setup(f,{emit:P}){const n=P,c=y(""),r=y("");K(()=>f.projectToEdit,o=>{o?(c.value=o.title,r.value=o.dueDate):(c.value="",r.value="")},{immediate:!0});const i=Q(()=>c.value.trim().length>0&&r.value.trim().length>0),_=()=>{if(!i.value)return;const o={title:c.value.trim(),dueDate:r.value};f.projectToEdit&&f.projectToEdit.id?n("update",{...o,id:f.projectToEdit.id}):n("create",o)},p=()=>{n("close")};return(o,s)=>(t(),m("div",{class:"project-modal flex justify-center align-center",onClick:M(p,["self"])},[e("div",ce,[e("div",ie,[e("h2",null,C(o.projectToEdit?"Edit project":"Create project"),1),b(k,{class:"cursor","no-padding":"",size:"sm",variant:"ghost","text-color":"var(--color-text)",onClickButton:p},{default:j(()=>[b(W)]),_:1})]),e("form",{class:"form",onSubmit:M(_,["prevent"])},[e("div",ue,[s[2]||(s[2]=e("label",{class:"form-label",for:"title"},"Title",-1)),S(e("input",{id:"title","onUpdate:modelValue":s[0]||(s[0]=a=>c.value=a),class:"form-input",required:""},null,512),[[F,c.value]])]),e("div",de,[s[3]||(s[3]=e("label",{class:"form-label",for:"due-date"},"Due date",-1)),S(e("input",{id:"due-date","onUpdate:modelValue":s[1]||(s[1]=a=>r.value=a),class:"form-input",type:"date"},null,512),[[F,r.value]])]),e("div",pe,[b(k,{type:"submit",disabled:!i.value},{default:j(()=>[x(C(o.projectToEdit?"Update":"Create"),1)]),_:1},8,["disabled"])])],32)])]))}}),me=B(ve,[["__scopeId","data-v-61b14bcd"]]),je={class:"project-card flex column"},fe={class:"project-row align-center"},_e={key:1},ye={class:"project-actions flex justify-end"},Pe=$({__name:"ProjectItem",props:{project:{}},emits:["edit-project","remove-project"],setup(f,{emit:P}){const n=P,r=L().name==="projects",i=V(),{isAuthenticated:_}=N(i);return(p,o)=>{const s=X("RouterLink");return t(),m("div",je,[e("div",fe,[e("div",null,[T(_)?(t(),d(s,{key:0,to:{name:"projectDetails",params:{id:p.project.id}},class:"project-link"},{default:j(()=>[x(C(p.project.title),1)]),_:1},8,["to"])):(t(),m("div",_e,C(p.project.title),1))]),e("div",null,C(T(ae)(p.project.dueDate)),1),e("div",ye,[r?(t(),d(k,{key:0,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[0]||(o[0]=a=>n("edit-project"))},{default:j(()=>[b(re)]),_:1})):v("",!0),r?(t(),d(k,{key:1,size:"sm",variant:"ghost","no-padding":"","text-color":"var(--color-text)",onClickButton:o[1]||(o[1]=a=>n("remove-project"))},{default:j(()=>[b(le)]),_:1})):v("",!0)])])])}}}),ge=B(Pe,[["__scopeId","data-v-bcff6552"]]),ke={class:"project-table flex column"},he=$({__name:"ProjectTable",props:{projects:{}},emits:["edit-project","remove-project"],setup(f,{emit:P}){const n=P;return(c,r)=>(t(),m("div",ke,[r[0]||(r[0]=e("div",{class:"project-header align-center"},[e("div",null,"Project title"),e("div",null,"Due date"),e("div")],-1)),(t(!0),m(z,null,Y(c.projects,i=>(t(),d(ge,{key:i.id,project:i,onEditProject:_=>n("edit-project",i),onRemoveProject:_=>n("remove-project",i.id)},null,8,["project","onEditProject","onRemoveProject"]))),128))]))}}),be=B(he,[["__scopeId","data-v-82953f51"]]),Ce={class:"container"},Ee={key:2,class:"project-page-header flex justify-between align-center"},we=$({__name:"ProjectList",setup(f){const n=L().name==="projects",{fetchProjectsAllAsync:c,createProjectAsync:r,updateProjectAsync:i,removeProjectAsync:_}=Z(),p=V(),{isAuthenticated:o}=N(p),s=y([]),a=y(!1),E=y(!1),R=y(null),g=y("");ee(()=>{w()});const A=()=>{R.value=null,E.value=!0},U=u=>{R.value=u,E.value=!0},D=()=>{E.value=!1},q=async u=>{a.value=!0;try{await r(u),await w()}catch(l){g.value=l.message||"Failed to create project."}finally{a.value=!1,D()}},G=async u=>{a.value=!0;try{await i(u),await w()}catch(l){g.value=l.message||"Failed to update project."}finally{a.value=!1,D()}},O=async u=>{const l=se(),{removeTaskAsync:H}=l,J=l.tasks.filter(h=>h.projectId===u);let I=[];a.value=!0;try{await _(u),I=J.map(h=>H(h.id)),await Promise.all(I),await w()}catch(h){g.value=h.message||"Failed to remove project."}finally{a.value=!1}},w=async()=>{a.value=!0;try{s.value=await c()}catch(u){g.value=u.message||"Failed to fetch projects."}finally{a.value=!1}};return(u,l)=>(t(),m("section",Ce,[a.value?(t(),d(oe,{key:0})):v("",!0),g.value?(t(),d(te,{key:1,message:g.value},null,8,["message"])):v("",!0),n?(t(),m("div",Ee,[l[1]||(l[1]=e("h1",null,"Projects",-1)),T(o)&&s.value.length>0?(t(),d(k,{key:0,onClickButton:A},{default:j(()=>l[0]||(l[0]=[x(" Create project ")])),_:1,__:[0]})):v("",!0)])):v("",!0),s.value.length>0?(t(),d(be,{key:3,projects:s.value,onEditProject:U,onRemoveProject:O},null,8,["projects"])):(t(),m(z,{key:4},[n?(t(),d(ne,{key:0,title:"No projects yet",message:"Start by creating your first project."},{action:j(()=>[T(o)?(t(),d(k,{key:0,onClickButton:A},{default:j(()=>l[2]||(l[2]=[x(" Create project ")])),_:1,__:[2]})):v("",!0)]),_:1})):v("",!0)],64)),E.value?(t(),d(me,{key:5,"project-to-edit":R.value,onClose:D,onCreate:q,onUpdate:G},null,8,["project-to-edit"])):v("",!0)]))}}),$e=B(we,[["__scopeId","data-v-ac36093f"]]);export{$e as P};
